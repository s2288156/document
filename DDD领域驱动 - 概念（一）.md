
![](https://wcy-img.oss-cn-beijing.aliyuncs.com/images/1-16x9.jpg)

## 概念

> 关键词：战略设计、战术设计、领域驱动、数据驱动、领域模型、领域对象、值对象、聚合、聚合根、领域、子域、核心域、通用域、支撑域、领域服务、应用服务、事件风暴

## 什么是DDD

DDD领域驱动不是架构，而是一种架构设计方法论。

在当今以微服务为主流的环境下，很多时候我们在拆分微服务的时候，往往是根据直觉、经验对服务进行拆分，比如订单服务、用户服务、支付服务。但这些服务只是将传统的单体架构拆分为了多个单体架构，当某一个服务的业务经过长期发展，业务越来越负责，代码越来越臃肿，服务中的某些核心业务性能出现瓶颈的时候，基于微服务的理念，可能需要将出现瓶颈的业务抽取为单独的服务进行水平扩展。这时我们发现，代码和业务都过于耦合，同一个服务中的业务之间边界不清晰，很难进行拆分。如果基于整个服务进行水平扩展，对服务器的资源浪费又比较严重，这就不利于架构的演进。

上面只是我们在微服务架构中遇到的众多问题中的一种，直到DDD的出现，通过领域建模，划分领域边界，再根据这些领域边界划分微服务，很好的贯彻了“高内聚、低耦合”的思想，它能指导我们设计出清晰的领域和应用边界，帮助我们更容易的实现架构演进。

## 战略设计和战术设计

![](https://wcy-img.oss-cn-beijing.aliyuncs.com/images/DDD/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8.png)

**战略设计:** 主要从业务角度出发，建立业务领域模型，划分领域边界

**战术设计：** 主要从技术角度出发，侧重于领域模型的技术实现，比如代码如何分层，包括聚合根、实体、值对象、领域服务、应用服务等代码逻辑的实现

## 设计聚合

![](https://wcy-img.oss-cn-beijing.aliyuncs.com/images/DDD/%E5%88%9B%E5%BB%BA%E8%AE%A2%E5%8D%95-%E5%AE%9E%E4%BD%93.png)

我们以电商的**创建订单**场景为例，简单对业务进行分析，并落实到DDD的各个概念：

1. 采用事件风暴，根据业务行为，梳理出所有创建订单的实体和值对象，比如：用户、商户、商品、订单、购物车等等
2. 找出聚合根，判断一个实体是不是聚合根，可以分析是否符合这些要素：
    - 独立的生命周期
    - 全局唯一ID
    - 可创建和修改其它对象
    - 有专门的模块管理这个实体
3. 根据业务单一职责和高内聚原则，找出和聚合根关联密切的所有实体和值对象，构建出1个包含聚合根（唯一）、多个实体和值对象的集合，这个集合就是聚合。这里我们可以构建出订单、用户、商户、商品四个聚合。